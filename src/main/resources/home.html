{{<chrome}}

  {{$js}}
    function rate(rid, score) {
      $('#rate-'+rid+' .rating-option').removeClass('selected');
      $('#rate-'+rid+'-'+score).addClass('selected');
      $('#rate-'+rid+'-submit').css('display', 'inline-block');
      $('#score-'+rid).text(score);
      $.ajax('/rate/'+rid, { type: 'POST', data: { score: score }});
    }

    function hideWeek(rid) {
      $('#weekend-'+rid).hide();
      $('#rating-'+rid).css('display', 'inline-block');
      $('html, body').animate({
        scrollTop: 0
      }, 100);
    }

    function showWeek(rid) {
      $('#weekend-'+rid).show();
      $('#rating-'+rid).hide();
    }
  {{/js}}

  {{$content}}

    {{#user}}
      <h2>Welcome, {{firstNameOption}}!</h2>
    {{/user}}

    {{#needToRate}}
      <div class="torate">
        You have {{toRate.length}} weekends to rate.
        Get started!
      </div>
      {{#checkinsByDayByUser}}
        <h1 class="weekend-header">
          {{#user.photoOption}}
            <img src="{{prefix}}40x40{{suffix}}"/>
          {{/user.photoOption}}
          {{user.firstNameOption}}'s weekend
          <div class="rating-summary" id="rating-{{rating.id}}">
            <div class="score" id="score-{{rating.id}}" onclick="showWeek('{{rating.id}}')">7</div>
          </div>
        </h1>

        <div class="weekend" id="weekend-{{rating.id}}">

          {{>checkin-detail}}

          <div class="rate" id="rate-{{rating.id}}">
            <h4 class="rating-label">Your rating:</h4>
            {{#ratingOptions}}
              <div class="rating-option" id="rate-{{rating.id}}-{{toString}}" onclick="rate('{{rating.id}}', {{toString}})">{{toString}}</div>
            {{/ratingOptions}}
            <div class="rating-option rating-option-submit" id="rate-{{rating.id}}-submit" onclick="hideWeek('{{rating.id}}')">submit</div>
            <div class="clear"></div>
          </div>
        </div>
      {{/checkinsByDayByUser}}
    {{/needToRate}}

    {{^needToRate}}
    <div class="myratings">
    </div>
    {{/needToRate}}

  {{/content}}
{{/chrome}}